<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Order Ojek Online</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
      background-color: #f5f7fa;
      color: #333;
      overflow: hidden;
    }

    .container {
      display: flex;
      flex-direction: column;
      height: 100vh;
      max-width: 600px;
      margin: 0 auto;
      background: white;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
      position: relative;
    }

    .header {
      background: linear-gradient(135deg, #4285f4, #34a853);
      color: white;
      padding: 20px;
      text-align: center;
      position: relative;
      z-index: 10;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    .header h1 {
      font-size: 1.5rem;
      margin-bottom: 5px;
    }

    .header p {
      font-size: 0.9rem;
      opacity: 0.9;
    }

    .map-container {
      flex: 1;
      position: relative;
    }

    #map {
      height: 100%;
      width: 100%;
    }

    .panel {
      position: absolute;
      top: 15px;
      left: 15px;
      right: 15px;
      background: white;
      border-radius: 16px;
      padding: 15px;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
      z-index: 5;
      transition: all 0.3s ease;
    }

    .input-group {
      display: flex;
      align-items: center;
      margin-bottom: 12px;
      position: relative;
    }

    .input-group i {
      position: absolute;
      left: 15px;
      color: #4285f4;
      font-size: 18px;
    }

    input {
      width: 100%;
      padding: 15px 15px 15px 45px;
      border: 1px solid #e0e0e0;
      border-radius: 12px;
      font-size: 16px;
      transition: border 0.3s;
      background: #f8f9fa;
    }

    input:focus {
      outline: none;
      border-color: #4285f4;
      box-shadow: 0 0 0 2px rgba(66, 133, 244, 0.2);
    }

    .order-summary {
      background: white;
      border-radius: 20px 20px 0 0;
      padding: 25px 20px;
      box-shadow: 0 -5px 15px rgba(0, 0, 0, 0.1);
      display: none;
      z-index: 10;
      position: relative;
    }

    .summary-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .summary-header h2 {
      color: #4285f4;
      font-size: 1.4rem;
    }

    .vehicle-type {
      background: #e8f0fe;
      color: #4285f4;
      padding: 6px 12px;
      border-radius: 20px;
      font-weight: 600;
      font-size: 14px;
    }

    .location-item {
      display: flex;
      margin-bottom: 20px;
    }

    .location-icon {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 15px;
      flex-shrink: 0;
    }

    .pickup-icon {
      background: #4285f4;
      color: white;
    }

    .destination-icon {
      background: #34a853;
      color: white;
    }

    .location-details {
      flex: 1;
    }

    .location-details h3 {
      font-size: 16px;
      margin-bottom: 5px;
      color: #555;
    }

    .location-details p {
      font-size: 14px;
      color: #888;
    }

    .divider {
      height: 1px;
      background: #eee;
      margin: 10px 0 20px 55px;
    }

    .info-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 15px;
      padding: 0 10px;
    }

    .info-label {
      color: #777;
      font-size: 15px;
    }

    .info-value {
      font-weight: 600;
      font-size: 15px;
      color: #333;
    }

    .price-value {
      color: #ea4335;
      font-size: 1.4rem;
      font-weight: 700;
    }

    .action-buttons {
      display: flex;
      gap: 15px;
      margin-top: 20px;
    }

    .btn {
      flex: 1;
      padding: 16px;
      border-radius: 12px;
      font-weight: 600;
      font-size: 16px;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }

    .btn i {
      margin-right: 8px;
    }

    .cancel-btn {
      background: #f8f9fa;
      color: #ea4335;
      border: 1px solid #eee;
    }

    .cancel-btn:hover {
      background: #f1f3f4;
    }

    .find-btn {
      background: linear-gradient(135deg, #4285f4, #34a853);
      color: white;
      box-shadow: 0 4px 10px rgba(66, 133, 244, 0.3);
    }

    .find-btn:hover {
      opacity: 0.95;
      transform: translateY(-2px);
    }

    .driver-screen {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: white;
      z-index: 20;
      padding: 25px;
      display: flex;
      flex-direction: column;
      display: none;
    }

    .driver-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
    }

    .driver-info {
      text-align: center;
      margin-bottom: 30px;
    }

    .driver-avatar {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      background: linear-gradient(135deg, #4285f4, #34a853);
      margin: 0 auto 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 40px;
      border: 4px solid white;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    .driver-info h2 {
      font-size: 1.6rem;
      margin-bottom: 5px;
      color: #333;
    }

    .driver-rating {
      color: #fbbc05;
      margin-bottom: 15px;
    }

    .driver-vehicle {
      background: #e8f0fe;
      color: #4285f4;
      padding: 8px 15px;
      border-radius: 20px;
      font-weight: 600;
      font-size: 14px;
      display: inline-block;
      margin-top: 10px;
    }

    .contact-btn {
      display: block;
      width: 100%;
      padding: 18px;
      background: linear-gradient(135deg, #4285f4, #34a853);
      color: white;
      border-radius: 14px;
      font-weight: 600;
      font-size: 18px;
      border: none;
      cursor: pointer;
      margin-top: 20px;
      box-shadow: 0 4px 15px rgba(66, 133, 244, 0.4);
      transition: all 0.2s;
    }

    .contact-btn:hover {
      opacity: 0.95;
      transform: translateY(-2px);
    }

    .back-btn {
      background: #f1f3f4;
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      color: #555;
    }

    .status-bar {
      background: #f8f9fa;
      border-radius: 12px;
      padding: 15px;
      margin: 20px 0;
      text-align: center;
      font-weight: 600;
      color: #ea4335;
      border: 1px solid #eee;
    }

    .radar {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 200px;
      height: 200px;
      transform: translate(-50%, -50%);
      z-index: 999;
      display: none;
    }

    .radar::before, .radar::after {
      content: "";
      position: absolute;
      width: 100%;
      height: 100%;
      border: 2px solid #00BFFF;
      border-radius: 50%;
      animation: radarPulse 2s infinite ease-out;
    }

    .radar::after {
      animation-delay: 1s;
    }

    .radar span {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: #00BFFF;
      font-weight: bold;
      background: rgba(255, 255, 255, 0.9);
      padding: 8px 12px;
      border-radius: 8px;
      box-shadow: 0 0 8px rgba(0,0,0,0.1);
    }

    @keyframes radarPulse {
      0% { transform: scale(0.4); opacity: 1; }
      100% { transform: scale(1.5); opacity: 0; }
    }

    .loading {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(255, 255, 255, 0.9);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 30;
      flex-direction: column;
      display: none;
    }

    .spinner {
      width: 50px;
      height: 50px;
      border: 5px solid rgba(66, 133, 244, 0.2);
      border-top: 5px solid #4285f4;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: 20px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .loading p {
      font-size: 18px;
      color: #4285f4;
      font-weight: 600;
    }

    .notification {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: white;
      padding: 15px 25px;
      border-radius: 12px;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
      z-index: 100;
      display: flex;
      align-items: center;
      gap: 10px;
      display: none;
    }

    .notification.success {
      border-left: 4px solid #34a853;
    }

    .notification.error {
      border-left: 4px solid #ea4335;
    }

    .notification i {
      font-size: 24px;
    }

    .success i {
      color: #34a853;
    }

    .error i {
      color: #ea4335;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>Order Ojek Online</h1>
      <p>Pesan kendaraan dengan mudah dan cepat</p>
    </div>
    
    <div class="map-container">
      <div id="map"></div>
      
      <div class="panel">
        <div class="input-group">
          <i class="fas fa-map-marker-alt"></i>
          <input type="text" id="fromInput" placeholder="Lokasi jemput" autocomplete="off">
        </div>
        <div class="input-group">
          <i class="fas fa-flag"></i>
          <input type="text" id="toInput" placeholder="Tujuan" autocomplete="off">
        </div>
      </div>
      
      <div class="radar" id="radar">
        <span>Mencari driver...</span>
      </div>
    </div>
    
    <div class="order-summary" id="orderSummary">
      <div class="summary-header">
        <h2>Ringkasan Order</h2>
        <div class="vehicle-type">MOTOR</div>
      </div>
      
      <div class="location-item">
        <div class="location-icon pickup-icon">
          <i class="fas fa-map-marker-alt"></i>
        </div>
        <div class="location-details">
          <h3>Lokasi Jemput</h3>
          <p id="pickupAddress">Jl. Sudirman No. 123, Jakarta Pusat</p>
        </div>
      </div>
      
      <div class="location-item">
        <div class="location-icon destination-icon">
          <i class="fas fa-flag"></i>
        </div>
        <div class="location-details">
          <h3>Lokasi Tujuan</h3>
          <p id="destinationAddress">Grand Indonesia, Jakarta Pusat</p>
        </div>
      </div>
      
      <div class="divider"></div>
      
      <div class="info-row">
        <div class="info-label">Durasi Perjalanan</div>
        <div class="info-value" id="duration">15 menit</div>
      </div>
      
      <div class="info-row">
        <div class="info-label">Jarak</div>
        <div class="info-value" id="distance">4.2 km</div>
      </div>
      
      <div class="info-row">
        <div class="info-label">Total Harga</div>
        <div class="price-value" id="totalPrice">Rp 21.000</div>
      </div>
      
      <div class="action-buttons">
        <button class="btn cancel-btn" id="cancelBtn">
          <i class="fas fa-times"></i> Batalkan
        </button>
        <button class="btn find-btn" id="findDriverBtn">
          <i class="fas fa-motorcycle"></i> Cari Driver
        </button>
      </div>
    </div>
    
    <div class="driver-screen" id="driverScreen">
      <div class="driver-header">
        <h2>Driver Ditemukan</h2>
        <button class="back-btn" id="backBtn">
          <i class="fas fa-arrow-left"></i>
        </button>
      </div>
      
      <div class="driver-info">
        <div class="driver-avatar">
          <i class="fas fa-user"></i>
        </div>
        <h2 id="driverName">Budi Santoso</h2>
        <div class="driver-rating">
          <i class="fas fa-star"></i>
          <i class="fas fa-star"></i>
          <i class="fas fa-star"></i>
          <i class="fas fa-star"></i>
          <i class="fas fa-star-half-alt"></i>
          <span>4.7</span>
        </div>
        <div class="driver-vehicle">
          <i class="fas fa-motorcycle"></i>
          <span id="vehicleType">Motor - Yamaha Mio</span>
        </div>
      </div>
      
      <div class="status-bar">
        <i class="fas fa-check-circle"></i>
        Driver dalam perjalanan menuju lokasi Anda
      </div>
      
      <div class="location-item">
        <div class="location-icon pickup-icon">
          <i class="fas fa-map-marker-alt"></i>
        </div>
        <div class="location-details">
          <h3>Lokasi Jemput</h3>
          <p id="driverPickupAddress">Jl. Sudirman No. 123, Jakarta Pusat</p>
        </div>
      </div>
      
      <div class="location-item">
        <div class="location-icon destination-icon">
          <i class="fas fa-flag"></i>
        </div>
        <div class="location-details">
          <h3>Lokasi Tujuan</h3>
          <p id="driverDestinationAddress">Grand Indonesia, Jakarta Pusat</p>
        </div>
      </div>
      
      <div class="info-row">
        <div class="info-label">Durasi Perjalanan</div>
        <div class="info-value" id="driverDuration">15 menit</div>
      </div>
      
      <div class="info-row">
        <div class="info-label">Total Harga</div>
        <div class="price-value" id="driverPrice">Rp 21.000</div>
      </div>
      
      <a href="tel:+628123456789" class="contact-btn">
        <i class="fas fa-phone"></i> Hubungi Driver
      </a>
    </div>
    
    <div class="loading" id="loading">
      <div class="spinner"></div>
      <p>Memproses...</p>
    </div>
  </div>
  
  <div class="notification" id="notification">
    <i class="fas fa-check-circle"></i>
    <span>Order berhasil dikirim!</span>
  </div>

  <script>
    // Data simulasi untuk contoh
    const orderData = {
      from: "Jl. Sudirman No. 123, Jakarta Pusat",
      to: "Grand Indonesia, Jakarta Pusat",
      vehicle: "motor",
      distance: "4.2 km",
      duration: "15 menit",
      totalPrice: 21000,
      userID: "V7CZwD0rSeQyQPN3AbWIPWMShfz1",
      userName: "Iron Yusuf",
      phone: "082311640444",
      status: "pending",
      from_lat: -6.2088,
      from_lng: 106.8456,
      to_lat: -6.1950,
      to_lng: 106.8205
    };

    const driverData = {
      driverID: "B1234XYZ",
      driverName: "Budi Santoso",
      kendaraan_driver: "Yamaha Mio",
      phone: "08123456789"
    };

    // Fungsi inisialisasi peta
    function initMap() {
      const lokasiA = { lat: orderData.from_lat, lng: orderData.from_lng };
      const lokasiB = { lat: orderData.to_lat, lng: orderData.to_lng };
      
      // Buat peta
      const map = new google.maps.Map(document.getElementById("map"), {
        zoom: 15,
        center: lokasiA,
        mapTypeControl: false,
        streetViewControl: false,
        fullscreenControl: false,
        styles: [
          { elementType: "geometry", stylers: [{ color: "#f5f5f5" }] },
          { elementType: "labels.text.stroke", stylers: [{ color: "#f5f5f5" }] },
          { elementType: "labels.text.fill", stylers: [{ color: "#333333" }] },
          {
            featureType: "road",
            elementType: "geometry",
            stylers: [{ color: "#ffffff" }]
          },
          {
            featureType: "road",
            elementType: "labels.text.fill",
            stylers: [{ color: "#5a5a5a" }]
          },
          {
            featureType: "poi",
            elementType: "geometry",
            stylers: [{ color: "#f5f5f5" }]
          },
          {
            featureType: "water",
            elementType: "geometry",
            stylers: [{ color: "#c9e7ff" }]
          }
        ]
      });
      
      // Tambahkan marker lokasi A
      new google.maps.Marker({
        position: lokasiA,
        map: map,
        icon: {
          url: "https://cdn-icons-png.flaticon.com/512/684/684908.png",
          scaledSize: new google.maps.Size(40, 40)
        }
      });
      
      // Tambahkan marker lokasi B
      new google.maps.Marker({
        position: lokasiB,
        map: map,
        icon: {
          url: "https://cdn-icons-png.flaticon.com/512/447/447031.png",
          scaledSize: new google.maps.Size(40, 40)
        }
      });
      
      // Tambahkan rute
      const directionsService = new google.maps.DirectionsService();
      const directionsRenderer = new google.maps.DirectionsRenderer({
        map: map,
        suppressMarkers: true,
        polylineOptions: {
          strokeColor: "#4285f4",
          strokeOpacity: 0.8,
          strokeWeight: 5
        }
      });
      
      directionsService.route(
        {
          origin: lokasiA,
          destination: lokasiB,
          travelMode: google.maps.TravelMode.DRIVING
        },
        (response, status) => {
          if (status === "OK") {
            directionsRenderer.setDirections(response);
          }
        }
      );
    }

    // Fungsi untuk menampilkan ringkasan order
    function showOrderSummary() {
      document.getElementById("orderSummary").style.display = "block";
      document.getElementById("pickupAddress").textContent = orderData.from;
      document.getElementById("destinationAddress").textContent = orderData.to;
      document.getElementById("duration").textContent = orderData.duration;
      document.getElementById("distance").textContent = orderData.distance;
      document.getElementById("totalPrice").textContent = `Rp ${orderData.totalPrice.toLocaleString("id-ID")}`;
      
      // Animasi scroll ke atas
      document.querySelector(".order-summary").scrollIntoView({ behavior: "smooth" });
    }

    // Fungsi untuk mengirim order ke Firebase
    function sendOrderToFirebase() {
      // Simulasi loading
      document.getElementById("loading").style.display = "flex";
      
      // Simulasi pengiriman data ke Firebase
      setTimeout(() => {
        document.getElementById("loading").style.display = "none";
        
        // Tampilkan notifikasi berhasil
        const notification = document.getElementById("notification");
        notification.classList.add("success");
        notification.innerHTML = '<i class="fas fa-check-circle"></i><span>Order berhasil dikirim! Mencari driver...</span>';
        notification.style.display = "flex";
        
        // Tampilkan animasi radar
        document.getElementById("radar").style.display = "flex";
        
        // Simulasi driver ditemukan setelah 5 detik
        setTimeout(() => {
          document.getElementById("radar").style.display = "none";
          showDriverScreen();
        }, 5000);
        
        // Sembunyikan notifikasi setelah 3 detik
        setTimeout(() => {
          notification.style.display = "none";
        }, 3000);
      }, 1500);
    }

    // Fungsi untuk menampilkan layar driver
    function showDriverScreen() {
      document.getElementById("driverScreen").style.display = "flex";
      document.getElementById("driverName").textContent = driverData.driverName;
      document.getElementById("vehicleType").textContent = driverData.kendaraan_driver;
      document.getElementById("driverPickupAddress").textContent = orderData.from;
      document.getElementById("driverDestinationAddress").textContent = orderData.to;
      document.getElementById("driverDuration").textContent = orderData.duration;
      document.getElementById("driverPrice").textContent = `Rp ${orderData.totalPrice.toLocaleString("id-ID")}`;
      
      // Update link telepon
      document.querySelector(".contact-btn").href = `tel:${driverData.phone}`;
    }

    // Fungsi untuk membatalkan order
    function cancelOrder() {
      // Simulasi pengiriman status dibatalkan
      const notification = document.getElementById("notification");
      notification.classList.add("error");
      notification.innerHTML = '<i class="fas fa-times-circle"></i><span>Order dibatalkan</span>';
      notification.style.display = "flex";
      
      // Sembunyikan ringkasan order
      document.getElementById("orderSummary").style.display = "none";
      
      // Reset form
      document.getElementById("fromInput").value = "";
      document.getElementById("toInput").value = "";
      
      // Sembunyikan notifikasi setelah 3 detik
      setTimeout(() => {
        notification.style.display = "none";
      }, 3000);
    }

    // Event listeners saat halaman dimuat
    document.addEventListener("DOMContentLoaded", () => {
      // Simulasi input alamat
      document.getElementById("fromInput").value = orderData.from;
      document.getElementById("toInput").value = orderData.to;
      
      // Tampilkan ringkasan order setelah input diisi
      setTimeout(showOrderSummary, 1000);
      
      // Event listener untuk tombol "Cari Driver"
      document.getElementById("findDriverBtn").addEventListener("click", sendOrderToFirebase);
      
      // Event listener untuk tombol "Batalkan"
      document.getElementById("cancelBtn").addEventListener("click", cancelOrder);
      
      // Event listener untuk tombol kembali di layar driver
      document.getElementById("backBtn").addEventListener("click", () => {
        document.getElementById("driverScreen").style.display = "none";
      });
    });

    // Inisialisasi Google Maps
    window.initMap = initMap;
  </script>
  
  <script>
  const key = new URLSearchParams(location.search).get("key");
  if (key) {
    const script = document.createElement("script");
    script.src = `https://maps.googleapis.com/maps/api/js?key=${key}&callback=initMap&libraries=places`;
    script.async = true;
    script.defer = true;
    document.head.appendChild(script);
  } else {
    alert("API Key tidak ditemukan di URL.");
  }
  </script>
</body>
</html>
